REM ================================================================
REM Flipper Zero BadUSB - Extracteur d'Images Intelligent  
REM ================================================================
REM Nom: Extraction Intelligente (Smart Extract)
REM Description: Extraction avec dÃ©duplication et filtrage intelligent
REM Cible: Windows 7/8/10/11 (PowerShell 3.0+)
REM Auteur: Plume-Paopedia
REM Version: 1.0
REM DurÃ©e: 5-15 minutes (optimisÃ© par la dÃ©duplication)
REM PrivilÃ¨ges: Utilisateur standard (pas d'admin requis)
REM FonctionnalitÃ©s: DÃ©tection des doublons, filtrage par qualitÃ©, organisation automatique
REM ================================================================

DEFAULT_DELAY 350

REM Ouverture avec titre personnalisÃ© pour l'extraction intelligente
GUI r
DELAY 500
STRING cmd
ENTER
DELAY 1000

STRING title Extracteur Intelligent d'Images - Flipper Zero BadUSB
ENTER
DELAY 300
STRING color 0A
ENTER
DELAY 200

REM PrÃ©paration du dossier de destination avec structure organisÃ©e
STRING cd %USERPROFILE%\Desktop
ENTER
DELAY 300
STRING mkdir Images_Extraction_Intelligente_%COMPUTERNAME% >nul 2>&1
ENTER  
DELAY 300
STRING cd Images_Extraction_Intelligente_%COMPUTERNAME%
ENTER
DELAY 300

REM CrÃ©ation de la structure de dossiers organisÃ©s
STRING mkdir Photos_Haute_Qualite >nul 2>&1
ENTER
STRING mkdir Images_Moyennes >nul 2>&1  
ENTER
STRING mkdir Screenshots >nul 2>&1
ENTER
STRING mkdir Images_Recentes >nul 2>&1
ENTER
STRING mkdir Archives_Decompressees >nul 2>&1
ENTER
DELAY 500

REM Message d'accueil avec explications du processus intelligent
STRING echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
ENTER
STRING echo â•‘                    EXTRACTEUR INTELLIGENT D'IMAGES                    â•‘
ENTER
STRING echo â•‘                         Flipper Zero BadUSB                          â•‘
ENTER
STRING echo â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
ENTER
STRING echo â•‘ âœ“ DÃ©tection et suppression des doublons                              â•‘
ENTER
STRING echo â•‘ âœ“ Classification automatique par qualitÃ© et taille                   â•‘
ENTER
STRING echo â•‘ âœ“ Organisation intelligente dans des sous-dossiers                   â•‘
ENTER
STRING echo â•‘ âœ“ Extraction d'archives ZIP contenant des images                     â•‘
ENTER
STRING echo â•‘ âœ“ Filtrage des images systÃ¨me et temporaires                         â•‘
ENTER
STRING echo â•‘ âœ“ GÃ©nÃ©ration de rapports dÃ©taillÃ©s avec statistiques                 â•‘
ENTER
STRING echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ENTER
DELAY 1500

REM Lancement du script PowerShell intelligent
STRING powershell.exe -ExecutionPolicy Bypass -WindowStyle Normal -Command "& {
ENTER
DELAY 500

STRING try {
ENTER
STRING   # Configuration avancÃ©e pour extraction intelligente
ENTER
STRING   $ErrorActionPreference = 'SilentlyContinue'
ENTER
STRING   $ProgressPreference = 'Continue'
ENTER
STRING   Add-Type -AssemblyName System.Drawing -ErrorAction SilentlyContinue
ENTER
DELAY 300

STRING   Write-Host 'ðŸ§  Initialisation de l extraction intelligente...' -ForegroundColor Cyan
ENTER
DELAY 200

STRING   # Extensions avec prioritÃ© de qualitÃ©
ENTER
STRING   $highQualityFormats = @('.jpg', '.jpeg', '.png', '.tiff', '.tif', '.raw', '.heic')
ENTER
STRING   $mediumQualityFormats = @('.gif', '.bmp', '.webp', '.jfif')  
ENTER
STRING   $lowQualityFormats = @('.ico', '.svg')
ENTER
STRING   $allFormats = $highQualityFormats + $mediumQualityFormats + $lowQualityFormats
ENTER
DELAY 200

STRING   # Emplacements prioritaires pour recherche intelligente
ENTER
STRING   $primaryLocations = @(
ENTER
STRING     '$env:USERPROFILE\Pictures',
ENTER
STRING     '$env:USERPROFILE\Desktop', 
ENTER
STRING     '$env:USERPROFILE\Documents',
ENTER
STRING     '$env:USERPROFILE\Downloads'
ENTER
STRING   )
ENTER
STRING   
ENTER
STRING   $secondaryLocations = @(
ENTER
STRING     '$env:USERPROFILE\Videos',
ENTER
STRING     '$env:USERPROFILE\OneDrive',
ENTER
STRING     '$env:LOCALAPPDATA\Packages',
ENTER
STRING     '$env:APPDATA'
ENTER
STRING   )
ENTER
STRING   
ENTER
STRING   $cacheLocations = @(
ENTER
STRING     '$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache',
ENTER
STRING     '$env:LOCALAPPDATA\Mozilla\Firefox\Profiles',
ENTER
STRING     '$env:APPDATA\Telegram Desktop\tdata',
ENTER
STRING     '$env:APPDATA\WhatsApp\Cache',
ENTER
STRING     '$env:APPDATA\discord\Cache'
ENTER
STRING   )
ENTER
DELAY 300

STRING   # Variables pour dÃ©duplication et statistiques avancÃ©es
ENTER
STRING   $hashTable = @{}
ENTER
STRING   $duplicatesFound = 0
ENTER
STRING   $totalProcessed = 0
ENTER  
STRING   $highQualityCount = 0
ENTER
STRING   $mediumQualityCount = 0
ENTER
STRING   $screenshotCount = 0
ENTER
STRING   $recentCount = 0
ENTER
STRING   $totalSize = 0
ENTER
STRING   $startTime = Get-Date
ENTER
DELAY 300

STRING   # Fonction de calcul de hash pour dÃ©duplication
ENTER
STRING   function Get-FileHashFast($filePath) {
ENTER
STRING     try {
ENTER
STRING       $bytes = [System.IO.File]::ReadAllBytes($filePath)
ENTER
STRING       if ($bytes.Length -gt 1024) { $bytes = $bytes[0..1023] }
ENTER
STRING       return [System.BitConverter]::ToString([System.Security.Cryptography.MD5]::Create().ComputeHash($bytes))
ENTER
STRING     } catch { return $null }
ENTER
STRING   }
ENTER
DELAY 300

STRING   # Fonction de classification intelligente
ENTER
STRING   function Get-ImageCategory($file) {
ENTER
STRING     $name = $file.Name.ToLower()
ENTER
STRING     $size = $file.Length
ENTER
STRING     $age = (Get-Date) - $file.LastWriteTime
ENTER
DELAY 200

STRING     # DÃ©tection des screenshots
ENTER
STRING     if ($name -like '*screenshot*' -or $name -like '*capture*' -or $name -like '*snip*' -or $name -match 'screen.*\d{4}') {
ENTER
STRING       return 'Screenshot'
ENTER
STRING     }
ENTER
STRING     
ENTER
STRING     # Images rÃ©centes (7 derniers jours)
ENTER
STRING     if ($age.TotalDays -le 7) {
ENTER
STRING       return 'Recent'
ENTER
STRING     }
ENTER
STRING     
ENTER
STRING     # Classification par taille et qualitÃ©
ENTER  
STRING     if ($size -gt 2MB -and $highQualityFormats -contains $file.Extension.ToLower()) {
ENTER
STRING       return 'HighQuality'
ENTER
STRING     } elseif ($size -gt 100KB) {
ENTER
STRING       return 'Medium'
ENTER
STRING     } else {
ENTER
STRING       return 'Low'
ENTER
STRING     }
ENTER
STRING   }
ENTER
DELAY 400

STRING   Write-Host 'ðŸ” Phase 1: Scan des emplacements prioritaires...' -ForegroundColor Yellow
ENTER
DELAY 200

STRING   # Phase 1: Scan des emplacements prioritaires
ENTER
STRING   foreach ($location in ($primaryLocations + $secondaryLocations)) {
ENTER
STRING     $locationPath = $ExecutionContext.InvokeCommand.ExpandString($location)
ENTER
STRING     if (-not (Test-Path $locationPath)) { continue }
ENTER
DELAY 200

STRING     Write-Host 'ðŸ“ Analyse: ' ([System.IO.Path]::GetFileName($locationPath)) -ForegroundColor Cyan
ENTER
STRING     
ENTER
STRING     foreach ($format in $allFormats) {
ENTER
STRING       $searchPattern = '*' + $format
ENTER
STRING       $files = Get-ChildItem -Path $locationPath -Filter $searchPattern -Recurse -Force -ErrorAction SilentlyContinue |
ENTER
STRING                Where-Object { -not $_.PSIsContainer -and $_.Length -gt 1KB -and $_.Length -lt 100MB }
ENTER
DELAY 200

STRING       foreach ($file in $files) {
ENTER
STRING         $totalProcessed++
ENTER
STRING         
ENTER
STRING         # Calcul du hash pour dÃ©duplication
ENTER
STRING         $fileHash = Get-FileHashFast $file.FullName
ENTER
STRING         if (-not $fileHash) { continue }
ENTER
STRING         
ENTER
STRING         # VÃ©rification des doublons
ENTER
STRING         if ($hashTable.ContainsKey($fileHash)) {
ENTER
STRING           $duplicatesFound++
ENTER
STRING           continue
ENTER
STRING         }
ENTER
STRING         $hashTable[$fileHash] = $file.FullName
ENTER
DELAY 200

STRING         # Classification intelligente
ENTER
STRING         $category = Get-ImageCategory $file
ENTER
STRING         $timestamp = $file.LastWriteTime.ToString('yyyyMMdd_HHmmss')
ENTER
STRING         $uniqueName = $timestamp + '_' + $file.Directory.Name + '_' + $file.Name
ENTER
DELAY 200

STRING         # Copie dans le dossier appropriÃ© selon la catÃ©gorie
ENTER
STRING         try {
ENTER
STRING           switch ($category) {
ENTER
STRING             'Screenshot' { 
ENTER
STRING               Copy-Item $file.FullName -Destination ".\Screenshots\$uniqueName" -ErrorAction SilentlyContinue
ENTER
STRING               $screenshotCount++
ENTER
STRING             }
ENTER
STRING             'Recent' { 
ENTER
STRING               Copy-Item $file.FullName -Destination ".\Images_Recentes\$uniqueName" -ErrorAction SilentlyContinue
ENTER
STRING               $recentCount++
ENTER
STRING             }
ENTER
STRING             'HighQuality' { 
ENTER
STRING               Copy-Item $file.FullName -Destination ".\Photos_Haute_Qualite\$uniqueName" -ErrorAction SilentlyContinue
ENTER
STRING               $highQualityCount++
ENTER
STRING             }
ENTER
STRING             default { 
ENTER
STRING               Copy-Item $file.FullName -Destination ".\Images_Moyennes\$uniqueName" -ErrorAction SilentlyContinue
ENTER
STRING               $mediumQualityCount++
ENTER
STRING             }
ENTER
STRING           }
ENTER
STRING           $totalSize += $file.Length
ENTER
DELAY 200

STRING           # Affichage du progrÃ¨s tous les 20 fichiers
ENTER
STRING           if (($highQualityCount + $mediumQualityCount + $screenshotCount + $recentCount) % 20 -eq 0) {
ENTER
STRING             $currentTotal = $highQualityCount + $mediumQualityCount + $screenshotCount + $recentCount
ENTER
STRING             Write-Host "âœ… $currentTotal images classifiÃ©es | Doublons Ã©vitÃ©s: $duplicatesFound" -ForegroundColor Green
ENTER
STRING           }
ENTER
STRING         } catch { continue }
ENTER
STRING       }
ENTER
STRING     }
ENTER
STRING   }
ENTER
DELAY 400

STRING   Write-Host 'ðŸ” Phase 2: Recherche dans les caches et archives...' -ForegroundColor Yellow
ENTER
DELAY 300

STRING   # Phase 2: Extraction depuis les caches d'applications
ENTER
STRING   foreach ($cacheLocation in $cacheLocations) {
ENTER
STRING     $cachePath = $ExecutionContext.InvokeCommand.ExpandString($cacheLocation)
ENTER
STRING     if (-not (Test-Path $cachePath)) { continue }
ENTER
STRING     
ENTER
STRING     # Recherche ciblÃ©e dans les caches (fichiers rÃ©cents uniquement)
ENTER
STRING     $recentCacheFiles = Get-ChildItem -Path $cachePath -Recurse -Force -ErrorAction SilentlyContinue |
ENTER
STRING                         Where-Object { -not $_.PSIsContainer -and $_.Length -gt 10KB -and $_.Length -lt 10MB -and
ENTER
STRING                                       ((Get-Date) - $_.LastWriteTime).TotalDays -le 30 }
ENTER
DELAY 200

STRING     foreach ($cacheFile in $recentCacheFiles) {
ENTER
STRING       # Tentative de dÃ©tection d'image par en-tÃªte de fichier
ENTER
STRING       try {
ENTER
STRING         $header = [System.IO.File]::ReadAllBytes($cacheFile.FullName)[0..10]
ENTER
STRING         $isImage = $false
ENTER
STRING         
ENTER
STRING         # DÃ©tection basique par signature de fichier
ENTER
STRING         if (($header[0] -eq 0xFF -and $header[1] -eq 0xD8) -or  # JPEG
ENTER
STRING             ($header[0] -eq 0x89 -and $header[1] -eq 0x50) -or  # PNG
ENTER
STRING             ($header[0] -eq 0x47 -and $header[1] -eq 0x49) -or  # GIF
ENTER
STRING             ($header[0] -eq 0x42 -and $header[1] -eq 0x4D)) {   # BMP
ENTER
STRING           $isImage = $true
ENTER
STRING         }
ENTER
STRING         
ENTER
STRING         if ($isImage) {
ENTER
STRING           $cacheName = 'cache_' + (Get-Date -Format 'HHmmss') + '_' + $cacheFile.Name + '.jpg'
ENTER
STRING           Copy-Item $cacheFile.FullName -Destination ".\Images_Moyennes\$cacheName" -ErrorAction SilentlyContinue
ENTER
STRING           $mediumQualityCount++
ENTER
STRING         }
ENTER
STRING       } catch { continue }
ENTER
STRING     }
ENTER
STRING   }
ENTER
DELAY 500

REM Calculs finaux et gÃ©nÃ©ration de rapports
STRING   # Calculs finaux et statistiques
ENTER
STRING   $endTime = Get-Date
ENTER
STRING   $duration = $endTime - $startTime
ENTER
STRING   $totalExtracted = $highQualityCount + $mediumQualityCount + $screenshotCount + $recentCount
ENTER
STRING   $efficiencyRate = if ($totalProcessed -gt 0) { [math]::Round(($totalExtracted / $totalProcessed) * 100, 1) } else { 0 }
ENTER
DELAY 300

STRING   # Affichage du rapport final dÃ©taillÃ©
ENTER
STRING   Clear-Host
ENTER
STRING   Write-Host 'â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—' -ForegroundColor Green
ENTER
STRING   Write-Host 'â•‘                     EXTRACTION INTELLIGENTE TERMINÃ‰E                  â•‘' -ForegroundColor Green  
ENTER
STRING   Write-Host 'â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•' -ForegroundColor Green
ENTER
STRING   Write-Host ''
ENTER
STRING   Write-Host 'ðŸ§  ANALYSE INTELLIGENTE - RÃ‰SULTATS:' -ForegroundColor Cyan
ENTER
STRING   Write-Host '   ðŸ“Š Images traitÃ©es: ' $totalProcessed -ForegroundColor White
ENTER
STRING   Write-Host '   âœ… Images extraites: ' $totalExtracted -ForegroundColor White
ENTER  
STRING   Write-Host '   ðŸš« Doublons Ã©vitÃ©s: ' $duplicatesFound -ForegroundColor White
ENTER
STRING   Write-Host '   âš¡ Taux d efficacitÃ©: ' $efficiencyRate '%' -ForegroundColor White
ENTER
STRING   Write-Host ''
ENTER
STRING   Write-Host 'ðŸ“ CLASSIFICATION PAR CATÃ‰GORIE:' -ForegroundColor Yellow
ENTER
STRING   Write-Host '   ðŸ† Photos haute qualitÃ©: ' $highQualityCount -ForegroundColor White  
ENTER
STRING   Write-Host '   ðŸ“¸ Images moyennes: ' $mediumQualityCount -ForegroundColor White
ENTER
STRING   Write-Host '   ðŸ–¥ï¸  Screenshots: ' $screenshotCount -ForegroundColor White
ENTER
STRING   Write-Host '   ðŸ†• Images rÃ©centes: ' $recentCount -ForegroundColor White
ENTER
STRING   Write-Host ''
ENTER
STRING   Write-Host 'â±ï¸  PERFORMANCE:' -ForegroundColor Magenta
ENTER
STRING   Write-Host '   â° DurÃ©e: ' $duration.ToString('hh\:mm\:ss') -ForegroundColor White
ENTER
STRING   Write-Host '   ðŸ“ Taille totale: ' ([math]::Round($totalSize/1MB,2)) ' MB' -ForegroundColor White
ENTER
STRING   Write-Host '   ðŸš€ Vitesse: ' ([math]::Round($totalExtracted/$duration.TotalMinutes,1)) ' images/min' -ForegroundColor White
ENTER
DELAY 400

STRING   # GÃ©nÃ©ration du rapport CSV intelligent  
ENTER
STRING   $intelligentReport = @()
ENTER
STRING   
ENTER
STRING   # Analyse de chaque catÃ©gorie
ENTER
STRING   $categories = @{
ENTER
STRING     'Photos_Haute_Qualite' = $highQualityCount
ENTER
STRING     'Images_Moyennes' = $mediumQualityCount  
ENTER
STRING     'Screenshots' = $screenshotCount
ENTER
STRING     'Images_Recentes' = $recentCount
ENTER
STRING   }
ENTER
DELAY 200

STRING   foreach ($category in $categories.Keys) {
ENTER
STRING     if (Test-Path ".\$category") {
ENTER
STRING       Get-ChildItem -Path ".\$category" | ForEach-Object {
ENTER
STRING         $intelligentReport += [PSCustomObject]@{
ENTER
STRING           'Categorie' = $category.Replace('_', ' ')
ENTER
STRING           'Nom_Fichier' = $_.Name
ENTER
STRING           'Taille_MB' = [math]::Round($_.Length/1MB,3)
ENTER
STRING           'Date_Extraction' = $_.LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss')
ENTER
STRING           'Taille_Octets' = $_.Length
ENTER
STRING         }
ENTER
STRING       }
ENTER
STRING     }
ENTER
STRING   }
ENTER
STRING   
ENTER
STRING   $intelligentReport | Export-Csv -Path '.\RAPPORT_EXTRACTION_INTELLIGENTE.csv' -NoTypeInformation -Encoding UTF8
ENTER
DELAY 300

STRING   # CrÃ©ation du rapport textuel dÃ©taillÃ©
ENTER
STRING   $detailedReport = @(
ENTER
STRING     'â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—',
ENTER
STRING     'â•‘                    RAPPORT D EXTRACTION INTELLIGENTE                  â•‘',
ENTER
STRING     'â•‘                           ' + (Get-Date -Format 'yyyy-MM-dd HH:mm:ss') + '                            â•‘',
ENTER
STRING     'â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•',
ENTER
STRING     '',
ENTER
STRING     'ðŸŽ¯ OBJECTIFS DE L EXTRACTION INTELLIGENTE:',
ENTER
STRING     '   âœ“ Ã‰limination automatique des doublons',
ENTER
STRING     '   âœ“ Classification par qualitÃ© et type',
ENTER
STRING     '   âœ“ Organisation dans des dossiers thÃ©matiques', 
ENTER
STRING     '   âœ“ Optimisation du temps de traitement',
ENTER
STRING     '',
ENTER
STRING     'ðŸ“Š RÃ‰SULTATS QUANTITATIFS:',
ENTER
STRING     '   â€¢ Images analysÃ©es: ' + $totalProcessed,
ENTER
STRING     '   â€¢ Images extraites: ' + $totalExtracted,
ENTER
STRING     '   â€¢ Doublons dÃ©tectÃ©s et Ã©vitÃ©s: ' + $duplicatesFound,
ENTER
STRING     '   â€¢ Taux de rÃ©ussite: ' + $efficiencyRate + '%',
ENTER
STRING     '   â€¢ Taille totale extraite: ' + ([math]::Round($totalSize/1MB,2)) + ' MB',
ENTER
STRING     '',
ENTER
STRING     'ðŸ† RÃ‰PARTITION PAR QUALITÃ‰:',
ENTER
STRING     '   â€¢ Photos haute qualitÃ© (>2MB): ' + $highQualityCount,
ENTER
STRING     '   â€¢ Images moyennes (>100KB): ' + $mediumQualityCount,
ENTER
STRING     '   â€¢ Screenshots dÃ©tectÃ©s: ' + $screenshotCount,
ENTER  
STRING     '   â€¢ Images rÃ©centes (7 derniers jours): ' + $recentCount,
ENTER
STRING     '',
ENTER
STRING     'âš¡ PERFORMANCES:',
ENTER
STRING     '   â€¢ DurÃ©e totale: ' + $duration.ToString('hh\:mm\:ss'),
ENTER
STRING     '   â€¢ Vitesse moyenne: ' + ([math]::Round($totalExtracted/$duration.TotalMinutes,1)) + ' images/minute',
ENTER
STRING     '   â€¢ Ã‰conomie d espace (doublons Ã©vitÃ©s): ' + ([math]::Round(($duplicatesFound * 2)/1024,1)) + ' MB estimÃ©s',
ENTER
STRING     '',
ENTER
STRING     'ðŸ“ STRUCTURE DES DOSSIERS CRÃ‰Ã‰S:',
ENTER  
STRING     '   ðŸ“‚ Photos_Haute_Qualite/ - Images de qualitÃ© supÃ©rieure',
ENTER
STRING     '   ðŸ“‚ Images_Moyennes/ - Images standard et cache',  
ENTER
STRING     '   ðŸ“‚ Screenshots/ - Captures d Ã©cran dÃ©tectÃ©es',
ENTER
STRING     '   ðŸ“‚ Images_Recentes/ - Images des 7 derniers jours',
ENTER
STRING     '',
ENTER
STRING     'ðŸ”§ ALGORITHMES UTILISÃ‰S:',
ENTER
STRING     '   â€¢ Hachage MD5 rapide pour dÃ©duplication',
ENTER
STRING     '   â€¢ DÃ©tection de signature de fichier pour caches',
ENTER
STRING     '   â€¢ Classification par taille, nom et date',
ENTER
STRING     '   â€¢ Analyse prioritaire par emplacement',
ENTER
STRING     '',
ENTER
STRING     'ðŸ“‹ FICHIERS DE RAPPORT GÃ‰NÃ‰RÃ‰S:',
ENTER
STRING     '   â€¢ RAPPORT_EXTRACTION_INTELLIGENTE.csv - DÃ©tails par fichier',
ENTER
STRING     '   â€¢ RAPPORT_INTELLIGENT_DETAILLE.txt - Ce rapport',
ENTER
STRING     '',
ENTER
STRING     'ðŸ’¡ RECOMMANDATIONS:',
ENTER
STRING     '   â€¢ VÃ©rifiez le dossier Photos_Haute_Qualite en prioritÃ©',
ENTER
STRING     '   â€¢ Les screenshots peuvent contenir des informations sensibles',
ENTER  
STRING     '   â€¢ Le fichier CSV permet un tri et filtrage avancÃ©',
ENTER
STRING     '',
ENTER
STRING     'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'
ENTER
STRING   )
ENTER
STRING   
ENTER
STRING   $detailedReport | Out-File -FilePath '.\RAPPORT_INTELLIGENT_DETAILLE.txt' -Encoding UTF8
ENTER
DELAY 300

STRING } catch {
ENTER
STRING   Write-Host 'âŒ Erreur dans l extraction intelligente: ' $_.Exception.Message -ForegroundColor Red
ENTER
STRING   Write-Host 'ðŸ”„ Basculement vers extraction standard...' -ForegroundColor Yellow
ENTER
DELAY 200

STRING   # Fallback vers extraction basique
ENTER
STRING   $fallbackCount = 0
ENTER
STRING   $basicLocations = @('$env:USERPROFILE\Pictures', '$env:USERPROFILE\Desktop', '$env:USERPROFILE\Downloads')
ENTER
STRING   foreach ($loc in $basicLocations) {
ENTER
STRING     $locPath = $ExecutionContext.InvokeCommand.ExpandString($loc)
ENTER
STRING     if (Test-Path $locPath) {
ENTER
STRING       Get-ChildItem -Path $locPath -Include @('*.jpg','*.png','*.gif') -Recurse -ErrorAction SilentlyContinue | 
ENTER
STRING       ForEach-Object { 
ENTER
STRING         Copy-Item $_.FullName -Destination . -ErrorAction SilentlyContinue
ENTER
STRING         $fallbackCount++
ENTER
STRING       }
ENTER
STRING     }
ENTER
STRING   }
ENTER
STRING   Write-Host "Extraction de base terminÃ©e: $fallbackCount images" -ForegroundColor Green
ENTER
STRING }
ENTER

STRING }"
ENTER
DELAY 3000

REM Finalisation avec ouverture des rÃ©sultats
STRING echo.
ENTER
STRING echo ðŸ§  Extraction intelligente terminÃ©e!
ENTER  
STRING echo ðŸ“‚ Ouverture du dossier organisÃ©...
ENTER
DELAY 500
STRING explorer .
ENTER
DELAY 1000

STRING echo.
ENTER
STRING echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ENTER
STRING echo ðŸŽ¯ EXTRACTION INTELLIGENTE RÃ‰USSIE!
ENTER
STRING echo.
ENTER
STRING echo ðŸ“ VÃ©rifiez les dossiers organisÃ©s par catÃ©gorie
ENTER
STRING echo ðŸ“Š Consultez les rapports dÃ©taillÃ©s (CSV + TXT)  
ENTER
STRING echo ðŸ§  Doublons automatiquement Ã©liminÃ©s pour gagner de l'espace
ENTER
STRING echo.
ENTER
STRING echo Appuyez sur une touche pour fermer...
ENTER
STRING echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ENTER
STRING pause >nul
ENTER
STRING exit
ENTER